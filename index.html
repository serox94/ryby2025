<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wędkarstwo w Enschede</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-image: url('tlo.jpg');
            background-size: cover;
            background-attachment: fixed;
            background-position: center;
        }
        
        .content-wrapper {
            background-color: rgba(255, 255, 255, 0.9);
            padding: 20px;
            border-radius: 8px;
        }
        
        header {
            background-color: #2c3e50;
            color: white;
            padding: 20px;
            text-align: center;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        h1, h2, h3 {
            color: #2c3e50;
        }
        
        .container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .box {
            background-color: rgba(255, 255, 255, 0.8);
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .countdown {
            font-size: 1.5em;
            font-weight: bold;
            color: #e74c3c;
            text-align: center;
            padding: 10px;
            background-color: rgba(255, 255, 255, 0.7);
            border-radius: 8px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        
        th {
            background-color: #3498db;
            color: white;
        }
        
        tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        
        .weather-alert {
            background-color: #f39c12;
            color: white;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 15px;
            font-weight: bold;
        }
        
        .fishing-tips {
            background-color: #27ae60;
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
        }
        
        .location-link {
            display: inline-block;
            background-color: #3498db;
            color: white;
            padding: 10px 15px;
            border-radius: 5px;
            text-decoration: none;
            margin: 10px 0;
        }
        
        .location-link:hover {
            background-color: #2980b9;
        }
        
        .weather-icon {
            width: 50px;
            height: 50px;
            vertical-align: middle;
        }
        
        @media (max-width: 768px) {
            .container {
                grid-template-columns: 1fr;
            }
        }
        
        .loading {
            font-style: italic;
            color: #7f8c8d;
        }
        
        /* Nowe style dla kalendarza brań */
        .fishing-calendar {
            width: 100%;
        }
        .fishing-calendar th {
            background-color: #2c3e50;
        }
        .fishing-calendar td {
            vertical-align: top;
        }
        .excellent {
            background-color: #27ae60;
            color: white;
            font-weight: bold;
        }
        .good {
            background-color: #2ecc71;
            color: white;
        }
        .average {
            background-color: #f39c12;
        }
        .poor {
            background-color: #e74c3c;
            color: white;
        }
        .moon-phase {
            font-size: 0.9em;
            color: #7f8c8d;
        }
        .time-range {
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="content-wrapper">
        <header>
            <h1>Wędkarstwo w Enschede</h1>
            <p>Przygotowania do wyprawy 1 czerwca</p>
        </header>
        
        <div class="countdown">
            <div id="current-time"></div>
            <div id="countdown"></div>
        </div>
        
        <div class="container">
            <div class="box">
                <h2>Aktualna pogoda w Enschede</h2>
                <div id="current-weather" class="loading">
                    <p>Ładowanie danych pogodowych...</p>
                </div>
            </div>
            
            <div class="box">
                <h2>Prognoza pogody na 5 dni</h2>
                <div id="weather-forecast" class="loading">
                    <p>Ładowanie prognozy pogody...</p>
                </div>
            </div>
        </div>
        
        <!-- Zaktualizowany kalendarz brań tylko na 1-7 czerwca -->
        <div class="box">
            <h2>Kalendarz brań dla karpia (1-7 czerwca 2025)</h2>
            <table class="fishing-calendar">
                <tr>
                    <th>Data</th>
                    <th>Dzień</th>
                    <th>Prognoza brań</th>
                    <th>Faza księżyca</th>
                    <th>Godziny aktywności</th>
                    <th>Optymalne warunki</th>
                </tr>
                <tr>
                    <td>1</td>
                    <td>Niedziela</td>
                    <td class="poor">Słabe</td>
                    <td class="moon-phase">Ostatnia kwadra (49%)<br>wsch. 03:24, zach. 19:46</td>
                    <td class="time-range">5:00-9:00, 18:00-22:00</td>
                    <td>Niskie ciśnienie (1005 hPa), wiatr NE 15 km/h</td>
                </tr>
                <tr>
                    <td>2</td>
                    <td>Poniedziałek</td>
                    <td class="good">Dobre</td>
                    <td class="moon-phase">Malejący księżyc (32%)</td>
                    <td class="time-range">4:30-8:30, 19:00-23:00</td>
                    <td>Ciśnienie rośnie (1010 hPa), lekki wiatr SW</td>
                </tr>
                <tr>
                    <td>3</td>
                    <td>Wtorek</td>
                    <td class="poor">Słabe</td>
                    <td class="moon-phase">Malejący księżyc (22%)</td>
                    <td>5:30-9:30</td>
                    <td>Wysokie ciśnienie (1018 hPa), bezchmurnie</td>
                </tr>
                <tr>
                    <td>4</td>
                    <td>Środa</td>
                    <td class="excellent">Znakomite</td>
                    <td class="moon-phase">Malejący sierp (12%)<br>wsch. 03:22, zach. 19:47</td>
                    <td class="time-range">3:45-7:30, 16:30-20:00</td>
                    <td>Ciśnienie spada (1008 hPa), zachmurzenie 70%</td>
                </tr>
                <tr>
                    <td>5</td>
                    <td>Czwartek</td>
                    <td class="excellent">Znakomite</td>
                    <td class="moon-phase">Nów (0%)<br>wsch. 03:21, zach. 19:49</td>
                    <td class="time-range">Całodobowe!</td>
                    <td>Nów księżyca, lekki deszcz, temp. wody 22°C</td>
                </tr>
                <tr>
                    <td>6</td>
                    <td>Piątek</td>
                    <td class="good">Dobre</td>
                    <td class="moon-phase">Rosnący sierp (5%)</td>
                    <td>5:00-9:00, 18:00-22:00</td>
                    <td>Ciśnienie stabilne (1012 hPa), wiatr W 10 km/h</td>
                </tr>
                <tr>
                    <td>7</td>
                    <td>Sobota</td>
                    <td class="poor">Fatalne</td>
                    <td class="moon-phase">Rosnący księżyc (10%)</td>
                    <td>6:00-10:00</td>
                    <td>Silny wiatr N 25 km/h, zimny front</td>
                </tr>
            </table>
            
            <h3>Legenda:</h3>
            <ul>
                <li><span class="excellent" style="padding: 2px 5px;">Znakomite</span> - Najlepsze dni na wędkowanie</li>
                <li><span class="good" style="padding: 2px 5px;">Dobre</span> - Dobre warunki do połowu</li>
                <li><span class="poor" style="padding: 2px 5px;">Słabe/Fatalne</span> - Trudne warunki, ryby mało aktywne</li>
            </ul>
        </div>
        
        <div class="box">
            <h2>Łowisko</h2>
            <a href="https://www.google.com/maps/place/Rutbekerveldweg+275,+7548+PP+Enschede,+Holandia/" class="location-link" target="_blank">
                Zobacz łowisko na mapie (Rutbekerveldweg 275, 7548 PP Enschede)
            </a>
        </div>
        
        <div class="container">
            <div class="box">
                <h2>Harmonogram przynęt - Maciek</h2>
                <table id="bait-schedule-maciek">
                    <tr>
                        <th>Data</th>
                        <th>Przynęta</th>
                        <th>Uwagi</th>
                    </tr>
                </table>
                <button onclick="addRow('bait-schedule-maciek')">Dodaj wpis</button>
            </div>
            
            <div class="box">
                <h2>Harmonogram przynęt - Patryk</h2>
                <table id="bait-schedule-patryk">
                    <tr>
                        <th>Data</th>
                        <th>Przynęta</th>
                        <th>Uwagi</th>
                    </tr>
                </table>
                <button onclick="addRow('bait-schedule-patryk')">Dodaj wpis</button>
            </div>
        </div>
        
        <div class="container">
            <div class="box">
                <h2>Dziennik połowów - Maciek</h2>
                <table id="fishing-log-maciek">
                    <tr>
                        <th>Data</th>
                        <th>Godzina</th>
                        <th>Gatunek</th>
                        <th>Waga</th>
                        <th>Przynęta</th>
                    </tr>
                </table>
                <button onclick="addRow('fishing-log-maciek')">Dodaj wpis</button>
            </div>
            
            <div class="box">
                <h2>Dziennik połowów - Patryk</h2>
                <table id="fishing-log-patryk">
                    <tr>
                        <th>Data</th>
                        <th>Godzina</th>
                        <th>Gatunek</th>
                        <th>Waga</th>
                        <th>Przynęta</th>
                    </tr>
                </table>
                <button onclick="addRow('fishing-log-patryk')">Dodaj wpis</button>
            </div>
        </div>
        
        <div id="weather-alerts" class="box">
            <h2>Alerty pogodowe</h2>
            <div id="alerts-container">
                <!-- Alerty będą dodawane dynamicznie -->
            </div>
        </div>
        
        <div class="fishing-tips">
            <h2>Porady wędkarskie</h2>
            <h3>Węzły dla karpia:</h3>
            <ul>
                <li><strong>Węzeł knotless knot</strong> - idealny do montażu włosowych na kulki proteinowe</li>
                <li><strong>Węzeł grinner</strong> - pewne połączenie przyponu z żyłką główną</li>
                <li><strong>Węzeł palomar</strong> - prosty i wytrzymały, dobry do łączenia haczyków</li>
            </ul>
            
            <h3>Porady dotyczące Deeper Chirp 2 Plus:</h3>
            <ul>
                <li>Użyj trybu CHIRP dla lepszej rozdzielczości w wodach do 40m</li>
                <li>Kalibruj echosondę przed każdym użyciem dla dokładniejszych odczytów</li>
                <li>Mapuj łowisko podczas niskiej aktywności ryb, aby stworzyć dokładną mapę dna</li>
                <li>Szukaj nagłych zmian głębokości i struktur na dnie - to ulubione miejsca karpia</li>
            </ul>
            
            <h3>Przynęty na karpia w czerwcu:</h3>
            <ul>
                <li>Kulki proteinowe o średnicy 14-18mm w smakach owocowych</li>
                <li>Kukurydza i pellet jako przynęta podstawowa</li>
                <li>Tiger nuts (orzechy tygrysie) moczone przez 24h przed użyciem</li>
                <li>W cieplejsze dni warto próbować lżejszych, pływających przynęt</li>
            </ul>
        </div>
    </div>

    <script>
        // API Key
        const API_KEY = 'fd3ff3668ce17f7d6ffe3073a1fb8a68';
        const CITY = 'Enschede';
        
        // Aktualny czas i odliczanie
        function updateTime() {
            const now = new Date();
            document.getElementById('current-time').textContent = `Aktualna godzina: ${now.toLocaleTimeString()}`;
            
            const targetDate = new Date('2024-06-01T14:00:00');
            const diff = targetDate - now;
            
            if (diff <= 0) {
                document.getElementById('countdown').textContent = "Czas nadszedł! Miłego wędkowania!";
                return;
            }
            
            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((diff % (1000 * 60)) / 1000);
            
            document.getElementById('countdown').textContent = `Do 1 czerwca 14:00 pozostało: ${days}d ${hours}h ${minutes}m ${seconds}s`;
        }
        
        setInterval(updateTime, 1000);
        updateTime();
        
        // Funkcja do dodawania wierszy do tabel
        function addRow(tableId) {
            const table = document.getElementById(tableId);
            const newRow = table.insertRow();
            
            if (tableId.includes('bait-schedule')) {
                newRow.innerHTML = `
                    <td><input type="date"></td>
                    <td><input type="text"></td>
                    <td><input type="text"></td>
                `;
            } else if (tableId.includes('fishing-log')) {
                newRow.innerHTML = `
                    <td><input type="date"></td>
                    <td><input type="time"></td>
                    <td><input type="text"></td>
                    <td><input type="number" step="0.1"></td>
                    <td><input type="text"></td>
                `;
            }
        }
        
        // Funkcja do tłumaczenia kierunku wiatru
        function getWindDirection(degrees) {
            const directions = ['Północny', 'Północno-Wschodni', 'Wschodni', 'Południowo-Wschodni', 
                              'Południowy', 'Południowo-Zachodni', 'Zachodni', 'Północno-Zachodni'];
            const index = Math.round((degrees % 360) / 45) % 8;
            return directions[index];
        }
        
        // Funkcja do pobierania aktualnej pogody
        async function fetchCurrentWeather() {
            try {
                const response = await fetch(
                    `https://api.openweathermap.org/data/2.5/weather?q=${CITY}&appid=${API_KEY}&units=metric&lang=pl`
                );
                const data = await response.json();
                
                if (data.cod !== 200) {
                    throw new Error(data.message || 'Nie udało się pobrać danych pogodowych');
                }
                
                const sunrise = new Date(data.sys.sunrise * 1000).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
                const sunset = new Date(data.sys.sunset * 1000).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
                
                document.getElementById('current-weather').innerHTML = `
                    <p><strong>Stan pogody:</strong> ${data.weather[0].description}</p>
                    <p><strong>Temperatura:</strong> ${Math.round(data.main.temp)}°C (odczuwalna ${Math.round(data.main.feels_like)}°C)</p>
                    <p><strong>Wschód słońca:</strong> ${sunrise}</p>
                    <p><strong>Zachód słońca:</strong> ${sunset}</p>
                    <p><strong>Wiatr:</strong> ${Math.round(data.wind.speed * 3.6)} km/h ${getWindDirection(data.wind.deg)}</p>
                    <p><strong>Ciśnienie:</strong> ${data.main.pressure} hPa</p>
                    <p><strong>Wilgotność:</strong> ${data.main.humidity}%</p>
                    <p><strong>Zachmurzenie:</strong> ${data.clouds.all}%</p>
                `;
                
                // Sprawdź czy są alerty pogodowe
                checkWeatherAlerts(data);
                
            } catch (error) {
                console.error('Błąd pobierania pogody:', error);
                document.getElementById('current-weather').innerHTML = `
                    <p>Nie udało się załadować aktualnej pogody. Spróbuj później.</p>
                    <p>Błąd: ${error.message}</p>
                `;
            }
        }
        
        // Funkcja do pobierania prognozy pogody
        async function fetchWeatherForecast() {
            try {
                const response = await fetch(
                    `https://api.openweathermap.org/data/2.5/forecast?q=${CITY}&appid=${API_KEY}&units=metric&lang=pl&cnt=40`
                );
                const data = await response.json();
                
                if (data.cod !== '200') {
                    throw new Error(data.message || 'Nie udało się pobrać prognozy pogody');
                }
                
                // Grupowanie prognozy po dniach
                const dailyForecast = {};
                data.list.forEach(item => {
                    const date = new Date(item.dt * 1000).toLocaleDateString();
                    if (!dailyForecast[date]) {
                        dailyForecast[date] = [];
                    }
                    dailyForecast[date].push(item);
                });
                
                // Generowanie tabeli prognozy
                let forecastHTML = '<table><tr><th>Data</th><th>Pogoda</th><th>Temp. (min/max)</th><th>Wiatr</th><th>Opady</th></tr>';
                
                // Ogranicz do 5 dni
                const dates = Object.keys(dailyForecast).slice(0, 5);
                
                dates.forEach(date => {
                    const dayData = dailyForecast[date];
                    const temps = dayData.map(item => item.main.temp);
                    const minTemp = Math.round(Math.min(...temps));
                    const maxTemp = Math.round(Math.max(...temps));
                    
                    // Znajdź prognozę na południe (najlepszą reprezentację dnia)
                    const middayForecast = dayData.find(item => {
                        const hours = new Date(item.dt * 1000).getHours();
                        return hours >= 11 && hours <= 14;
                    }) || dayData[Math.floor(dayData.length / 2)];
                    
                    forecastHTML += `
                        <tr>
                            <td>${date}</td>
                            <td>
                                <img src="https://openweathermap.org/img/wn/${middayForecast.weather[0].icon}.png" 
                                     alt="${middayForecast.weather[0].description}" class="weather-icon">
                                ${middayForecast.weather[0].description}
                            </td>
                            <td>${minTemp}°C / ${maxTemp}°C</td>
                            <td>${Math.round(middayForecast.wind.speed * 3.6)} km/h ${getWindDirection(middayForecast.wind.deg)}</td>
                            <td>${middayForecast.pop ? Math.round(middayForecast.pop * 100) : 0}%</td>
                        </tr>
                    `;
                });
                
                forecastHTML += '</table>';
                document.getElementById('weather-forecast').innerHTML = forecastHTML;
                
            } catch (error) {
                console.error('Błąd pobierania prognozy:', error);
                document.getElementById('weather-forecast').innerHTML = `
                    <p>Nie udało się załadować prognozy pogody. Spróbuj później.</p>
                    <p>Błąd: ${error.message}</p>
                `;
            }
        }
        
        // Funkcja do sprawdzania alertów pogodowych
        function checkWeatherAlerts(weatherData) {
            const alertsContainer = document.getElementById('alerts-container');
            alertsContainer.innerHTML = '';
            
            // Sprawdź warunki, które mogą być problematyczne dla wędkowania
            const alerts = [];
            
            if (weatherData.wind.speed * 3.6 > 20) { // Wiatr > 20 km/h
                alerts.push({
                    level: 'warning',
                    message: `Silny wiatr (${Math.round(weatherData.wind.speed * 3.6)} km/h) - utrudnione zarzucanie i kontrolowanie zestawu`
                });
            }
            
            if (weatherData.rain && weatherData.rain['1h'] > 5) {
                alerts.push({
                    level: 'info',
                    message: 'Intensywne opady deszczu - przygotuj się na mokre warunki'
                });
            }
            
            if (weatherData.main.temp < 10) {
                alerts.push({
                    level: 'info',
                    message: 'Niska temperatura - ryby mogą być mniej aktywne'
                });
            }
            
            if (alerts.length === 0) {
                alerts.push({
                    level: 'success',
                    message: 'Brak alertów pogodowych - dobre warunki do wędkowania'
                });
            }
            
            alerts.forEach(alert => {
                const alertDiv = document.createElement('div');
                alertDiv.className = `weather-alert ${alert.level}`;
                alertDiv.textContent = alert.message;
                alertsContainer.appendChild(alertDiv);
            });
        }
        
        // Dodaj styl dla różnych poziomów alertów
        const style = document.createElement('style');
        style.textContent = `
            .weather-alert.success {
                background-color: #27ae60;
            }
            .weather-alert.warning {
                background-color: #f39c12;
            }
            .weather-alert.info {
                background-color: #3498db;
            }
        `;
        document.head.appendChild(style);
        
        // Załadowanie danych pogodowych po załadowaniu strony
        window.onload = () => {
            updateTime();
            fetchCurrentWeather();
            fetchWeatherForecast();
        };
    </script>
</body>
</html>
